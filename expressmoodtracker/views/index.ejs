<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Express Favourites</title>
    <link rel="icon" href="/imgs/favicon-16x16.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js" integrity="sha512-ZwR1/gSZM3ai6vCdI+LVF1zSq/5HznD3ZSTk7kajkaj4D292NLuduDCO1c/NT8Id+jE58KYLKT7hXnbtryGmMg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <%- include('navbar', { isLoggedIn, currentPage }) %>
    <section class="section">
        <div class="container">
            <h1 class="title">Mood Tracker</h1>

            <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Favourite</th>
                    </tr>
                </thead>
                <tbody>
                    <% result.forEach((row) => { %>
                        <tr>
                            <td><%= row.person %></td>
                            <td><%= row.favourite %></td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <div class="columns is-centred">
                <canvas id="bkgcanvas" width="500px" height="500px"></canvas>
            </div>
        </div>
    </section>

    <script>
        const xlabels = ["Meat", "Fish", "Vegetables", "Desert"];
        const yvals = JSON.parse(`<%- JSON.stringify(vals) %>`);
        console.log(yvals);

        const chartdata = {
            labels: xlabels,
            datasets: [{
                data: yvals
            }]
        };

        const chartconfig = {
            type: 'bar',
            data: chartdata,
            options: {
                responsive: false,
                animation: true,
                maintainAspectRatio: true,
                scales: { y: { min: 0, max: 10 } },
                plugins: {
                    legend: { display: false },
                    tooltips: { enabled: true },
                    title: {
                        display: true,
                        text: 'Favourites Histogram',
                        font: { size: 20 }
                    }
                }
            }
        };

        const chart = new Chart('bkgcanvas', chartconfig);



    </script>
    
    
</body>
</html>